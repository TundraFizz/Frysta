<style>

html {
  font: 14px/24px "lato", sans-serif;
  background-color: #33363f;
  color: #c0c0c0;
}

body {
  margin: 0;
}

#buttons {
}

.btn {
  position: relative;
  width: 100px;
  height: 32px;
  background-color: darkgray;
  color: black;
  border: 1px solid black;
  cursor: pointer;
  text-align: center;
  line-height: 32px;
  display: inline-block;
}
.btn:active {
  background-color: lightgray;
}

.no-select {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

#btn-screenshot {
}

#titlebar {
  -webkit-user-select: none;
  -webkit-app-region: drag;
  height: 18px;
  border: solid black;
  border-width: 0px 0px 1px 0px;
  box-shadow: 0px 0px 6px 0px #5fb9ff;
}

#title-text {
  position: relative;
  top: -3px;
  left: 4px;
  height: 18px;
  font-size: 12px;
  font-weight: bold;
}

#titlebar > div {
  display: inline-block;
}

.titlebar-button {
  -webkit-app-region: no-drag;
  width: 22px;
  height: 18px;
  float: right;
  cursor: pointer;
}

#btn-minimize {
  text-align: center;
  line-height: 1.25;
}

#btn-minimize:hover {
  background-color: #3336c8;
}

#btn-minimize:active {
  background-color: #3336e1;
}

#btn-quit {
  text-align: center;
  line-height: 1.25;
}

#btn-quit:hover {
  background-color: #c8363f;
}

#btn-quit:active {
  background-color: #e1363f;
}

#lioca {
  cursor: default;
}

#menu-buttons {
  width: 100%;
  font-size: 0px;
  height: 30px;
  display: table;
}

.menu-button {
  display: inline-block;
  width: 50%;
  font-size: 16px;
  text-align: center;
  display: table-cell;
  vertical-align: middle;
}

.menu-button[active="true"] {
  text-shadow: 0px 0px 8px #5fff79;
}

.menu-button[active="false"] {
  cursor: pointer;
  /*color: rgba(0, 0, 0, 0.4);*/
}

.menu-button[active="false"]:hover {
  cursor: pointer;
  /*color: rgba(0, 0, 0, 0.7);*/
}

#menu-line-bg {
  background-color: black;
  height: 1px;
}

#menu-line-fg {
  position: relative;
  background-color: #c0c0c0;
  height: 1px;
  width: 50%;
  left: 0%;
}

#input-field-container {
  position: relative;
  width: 100%;
  height: 82px;
}

#input-field-email {
  top: 4px;
  visibility: hidden;
  opacity: 0;
}

#input-field-username {
  top: 14px;
}

#input-field-password {
  top: 48px;
}

.input-field {
  position: absolute;
  width: 50%;
  left: 25%;
}

.input-label {
  position: absolute;
  left: 6px;
  color: rgba(0, 0, 0, 0.7);
  pointer-events: none;
  height: 100%;
}

.input-field > input {
  width: 100%;
  display: block;
}

#login-button-container {
  text-align: center;
  height: 32px;
}

.btn2 {
  border-radius: 4px;
  position: relative;
  width: 54px;
  height: 22px;
  background-color: #3e424e;
  border: 1px solid #4d515c;
  cursor: pointer;
  text-align: center;
  line-height: 22px;
  display: inline-block;
  box-shadow: 0px 0px 5px 0px #5fb9ff;
}

/*.btn2:hover {
  box-shadow: 0px 0px 10px 0px #5fb9ff;
}

.btn2:active {
  box-shadow: 0px 0px 0px 0px #5fb9ff;
}*/

#loading {
  position: relative;
  top: -26px;
  width: 28px;
  height: 28px;
  margin: 0 auto;
  opacity: 0;
  visibility: hidden;
  background-image: url(loading.svg);
}

#message-container{
  text-align: center;
  height: 28px;
}

#message {
  border-radius: 4px;
  cursor: default;
  line-height: 18px;
  display: inline-block;
  padding: 0px 2px;
  opacity: 0;
}

.alert-green {
  background-color: #194e1f;
  border: #2eb13c;
  box-shadow: 0px 0px 5px 0px #24dc48;
}

.alert-red {
  background-color: #630000;
  border: #900000;
  box-shadow: 0px 0px 5px 0px #ff4040;
}

#app-1 {}
#app-2 {display: none;}

</style>

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link href="http://fonts.googleapis.com/css?family=Lato:100,400,700|Playfair+Display:400italic|Source+Code+Pro" rel="stylesheet" type="text/css">
    <title>Frysta</title>
    <script>if(typeof module === "object") {window.module = module; module = undefined;}</script>
    <script src="./node_modules/jquery/dist/jquery.js"></script>
    <script src="./jquery-animate-shadow.js"></script>
  </head>
  <body>
    <div id="titlebar">
      <div id="title-text"   class="no-select">Frysta</div>
      <div id="btn-quit"     class="no-select titlebar-button">⨉</div>
      <div id="btn-minimize" class="no-select titlebar-button">—</div>
    </div>

    <div id="app-1">
      <div id="lioca" class="no-select">
        <div id="menu-buttons">
          <div id="menu-login"          class="menu-button" active="true">Login</div>
          <div id="menu-create-account" class="menu-button" active="false">Create Account</div>
        </div>
        <div id="menu-line-bg">
          <div id="menu-line-fg"></div>
        </div>
      </div>

      <div id="input-field-container">
        <div id="input-field-email" class="input-field">
          <span class="input-label no-select">Email address</span>
          <input name="email" type="text">
        </div>
        <div id="input-field-username" class="input-field">
          <span class="input-label no-select">Username</span>
          <input name="username" type="text">
        </div>
        <div id="input-field-password" class="input-field">
          <span class="input-label no-select">Password</span>
          <input name="password" type="password">
        </div>
      </div>

      <div id="login-button-container">
        <div id="submit" class="btn2 no-select">
          <div>Submit</div>
        </div>
        <div id="loading"></div>
      </div>

      <div id="message-container" class="no-select">
        <div id="message"></div>
      </div>
    </div>

    <div id="app-2">
      <div>dsjfkhsd kjsdfhksd kjhk</div>

      <div id="buttons">
        <div id="btn-screenshot" class="btn no-select">Screenshot</div>
      </div>

      <div>
        <div>-----------------------------------------------------</div>
        <div id="url-here"></div>
        <div>-----------------------------------------------------</div>
      </div>
    </div>
  </body>
</html>

<script>

$(".btn2").hover(function(){
  $(this).animate({
    "box-shadow": "0px 0px 10px 0px #5fb9ff"
  }, 50);
}, function(){
  $(this).animate({
    "box-shadow": "0px 0px 5px 0px #5fb9ff"
  }, 50);
});

$(".btn2").mousedown(function(){
  $(this).animate({
    "box-shadow": "0px 0px 0px 0px #5fb9ff"
  }, 50);
});

$(".btn2").mouseup(function(){
  $(this).animate({
    "box-shadow": "0px 0px 5px 0px #5fb9ff"
  }, 50);
});

const ipc         = require("electron").ipcRenderer;
const EmitMessage = require("electron").remote.app.emit;

function SendMessage(func, data=null){
  EmitMessage("message", {
    "function": func,
    "data"    : JSON.stringify(data)
  });
}

// Sending messages to main.js
$("#btn-screenshot").click(function(){
  SendMessage("TakeScreenshot");
});

$("#btn-minimize").click(function(){
  SendMessage("Minimize");
});

$("#btn-quit").click(function(){
  SendMessage("Quit");
});

$("#submit").click(function(){
  $("div", this).animate({
    "opacity": "0"
  }, 100);

  $(this).animate({
    "width": "22px",
    "border-radius": "12px"
  }, 100, function(){
    $(this).animate({
      "opacity": "0"
    }, 100);
    $("#loading").animate({
      "opacity": "1"
    }, 100);

    $("#loading").css("visibility", "visible");
  });

  var selection = $($(".menu-button[active='true']")[0]).text();
  var data      = {};

  if(selection == "Login"){
    data["username"] = $("input[name='username']").val();
    data["password"] = $("input[name='password']").val();
    SendMessage("Login", data);
  }else if(selection == "Create Account"){
    data["email"]    = $("input[name='email']").val();
    data["username"] = $("input[name='username']").val();
    data["password"] = $("input[name='password']").val();
    SendMessage("CreateAccount", data);
  }
});

$("#test-save").click(function(){
  SendMessage("TestSave");
});

$("#test-load").click(function(){
  SendMessage("TestLoad");
});

$("input").on("focus",function(){
  var text = $(this).val();
  var span = $("span", $(this).parent())[0];
  if(!text)
    $(span).css("color", "rgba(0, 0, 0, 0.4)");
});

$("input").on("blur",function(){
  var text = $(this).val();
  var span = $("span", $(this).parent())[0];
  if(!text)
    $(span).css("color", "rgba(0, 0, 0, 0.7)");
});

$("input").on("input", function(){
  var text = $(this).val();
  var span = $("span", $(this).parent())[0];
  if(text)
    $(span).hide();
  else
    $(span).show();
});

$("#menu-login").click(function(){
  if($(this).attr("active") == "false"){
    $("#menu-login").attr("active", "true");
    $("#menu-create-account").attr("active", "false");

    // Animate the line
    $("#menu-line-fg").animate({
      "left": "0%"
    }, {duration: 250, queue: false});

    $("#input-field-username").animate({
      "top": "14px"
    }, {duration: 250, queue: false});

    $("#input-field-password").animate({
      "top": "48px"
    }, {duration: 250, queue: false});

    $("#input-field-email").animate({
      "opacity": "0"
    }, {duration: 250, queue: false, complete: function(){
      $("#input-field-email").css("visibility", "hidden", "important");
    }});
  }
});

$("#menu-create-account").click(function(){
  if($(this).attr("active") == "false"){
    $("#menu-login").attr("active", "false");
    $("#menu-create-account").attr("active", "true");

    // Animate the line
    $("#menu-line-fg").animate({
      "left": "50%"
    }, {duration: 250, queue: false});

    $("#input-field-username").animate({
      "top": "30px"
    }, {duration: 250, queue: false});

    $("#input-field-password").animate({
      "top": "56px"
    }, {duration: 250, queue: false});

    $("#input-field-email").animate({
      "opacity": "1"
    }, {duration: 250, queue: false});

    $("#input-field-email").css("visibility", "visible", "important");
  }
});

function LoadingToSubmit(data){
  var msg = data["msg"];
  var err = data["err"];

  $("#loading").animate({
    "opacity": "0"
  }, 100, function(){
    $("#loading").css("visibility", "hidden");
  });

  $("#submit").animate({
    "opacity": "1"
  }, 100, function(){

    $("#submit").animate({
      "width": "54px",
      "border-radius": "4px"
    }, 100);

    $("#submit > div").animate({
      "opacity": "1"
    }, 100);

    $("#message").animate({
      "opacity": "1"
    }, 100);

    $("#message").removeClass();

    if(err == "true"){
      $("#message").addClass("alert-red");
    }else if(err == "false"){
      $("#message").addClass("alert-green");
      setTimeout(TransitionToMain, 1);
    }

    $("#message").text(msg);
  });
}

function TransitionToMain(){
  $("#app-1").css("display", "none");
  $("#app-2").css("display", "block");
}
$("#app-2").css("display", "block");
// Receiving a message from main.js
ipc.on("message", (event, msg) => {
  var func = msg["function"];
  var data = JSON.parse(msg["data"]);

  if(func == "YoloSwag") LoadingToSubmit(data);
})

</script>
